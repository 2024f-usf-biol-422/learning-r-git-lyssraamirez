---
Author: Alyssa Ramirez
title: "Analysis of SARS-CoV2 SNPs"
output: html_document
date: "2024-10"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Setup
```{r Setup-chunk}
snp_file <- "data/sample_snp_data.csv"
sample_id <- "SRR12433063"
```

```{r Load necessary packages}
# Load required libraries and source the function

library(ggplot2)
source("code/functions/SNP_analyzation.R")
```

## Project description
In this project, we analyze a data set of single nucleotide polymorphisms to 
investigate genetic variation in multiple genome samples. The analysis focuses 
on extracting data from a specific sample, visualizing SNP quality scores, and
generating different types of figures to demonstrate the results of each
genome. In Figure one chromosome position is on the x and quality score is on 
y. [@ggplot] was used to execute a accurate visual box plot and scatter plot. 
The data in these graphs was subset from a large set of SNP samples, [@dplyr] 
was used to manipulate the data from the original data frame. To accurately 
apply references and citations to support the figures [@citr] was used to cite 
R packages. Chat GPT was also used as a reference in code of figures.

## Subsetting data
```{r subet-data}
# Pass only the SNP_file and sample_id arguments
single_sample_data <- subset_snp_data(file_path = snp_file,
                                      sample_id = sample_id)
# Create a csv file for subset data
output_file <- paste0("data/subset_snp_data", sample_id, ".csv")
write.csv(single_sample_data, file = output_file, row.names = FALSE)

# Confirmation message
cat("subset file saved as:", output_file)
```

## Figures
```{r snp-scatterplot, echo=FALSE, message=FALSE,warning=FALSE}
# Scatterplot of SNP quality scores
scatter_plot <- ggplot(single_sample_data, aes(x = pos, y = qual)) +
  geom_point(alpha = 0.6) +
  labs(
       title = paste("SNP quality scores by position for sample", sample_id),
       x = "Position in Genome",
       y = "SNP Quality Score") +
  theme_minimal()

# Save the scatterplot
ggsave(filename = paste0("output/scatter_plot", sample_id, ".png"),
       plot = scatter_plot, width = 8, height = 6)

# Display the plot
scatter_plot
```

```{r figues-boxplot-}
# Boxplot of SNP Quality Scores by Position Category (e.g., grouped by bins)
boxplot_plot <- ggplot(single_sample_data, aes(x = factor(pos %/% 1000),
                                               y = qual)) +
  geom_boxplot(fill = "skyblue", color = "black", outlier.colour = "red",
               outlier.shape = 16) +
  labs(
    title = paste("Boxplot of SNP Quality Scores for Sample", sample_id),
    x = "Position in Genome (in bins of 1000)",
    y = "SNP Quality Score"
  ) +
  theme_minimal()

# Save the box plot to a PNG file
ggsave(filename = paste0("output/box_plot_", sample_id, ".png"),
       plot = boxplot_plot, width = 8, height = 6)

# Display the boxplot
boxplot_plot
```
## Session Info
```{r session-info, echo=FALSE}
# Print session information
devtools::session_info()
```

## Soures Cited
```{r}

```

